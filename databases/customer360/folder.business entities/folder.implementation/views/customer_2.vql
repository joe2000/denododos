CREATE OR REPLACE VIEW customer_2 FOLDER = '/business entities/implementation' DESCRIPTION = 'Aggregated view of a customer, including the company they belong to.' 
    PRIMARY KEY ( 'id' ) AS SELECT client.client_id AS id, client.name AS name, client.surname AS surname, ((client.name||' ')||client.surname) AS full_name, client.ssn AS ssn, client_type.value AS type, company.name AS company_name, address.state AS state, address.country AS country, address.street AS street, address.city AS city, address.zip AS zip, address.primary_phone AS primary_phone FROM ((client AS client INNER JOIN client_type AS client_type ON client.client_type = client_type.code ) INNER JOIN address AS address ON client.client_id = address.client_identifier ) INNER JOIN company AS company ON client.company_code = replace(company.code, 'ENT', 'COM')  ORDER BY id ASC;


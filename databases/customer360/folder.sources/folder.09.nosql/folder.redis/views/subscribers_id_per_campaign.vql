CREATE OR REPLACE VIEW subscribers_id_per_campaign FOLDER = '/sources/09.nosql/redis' AS SELECT pushd_event_subscribers.zset AS subscribers, sf_campaign.name AS name, sf_campaign.description AS description, sf_campaign.type AS type, sf_campaign.enddate AS enddate, sf_campaign.startdate AS startdate, sf_campaign.status AS status FROM pushd_event_subscribers AS pushd_event_subscribers NESTED REVERSEORDER INNER JOIN (sf_campaign AS sf_campaign INNER JOIN campaigns_events_mapping AS campaigns_events_mapping ON sf_campaign.id = campaigns_events_mapping."Campaigns identifiers" ) ON pushd_event_subscribers.key = (('event:'||campaigns_events_mapping."Events identifiers")||':subs') ;

